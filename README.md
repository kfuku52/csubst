![](logo/logo_csubst.svg)

## Overview
**csubst** is a tool for molecular convergence detection in DNA/codon/protein sequences.

## Input files
**csubst** takes as inputs a rooted tree, a multiple sequence alignment, and posterior probabilities or maximum-likelihood estimates of ancestral sequences that are generated by phylogenetic softwares. Currently, ancestral sequences from following programs are supported.
* [IQ-TREE](http://www.iqtree.org/)
* [PhyloBayes](http://www.atgc-montpellier.fr/phylobayes/)

## Dependencies
**csubst** runs on python >3.5 and depends on the following python packages.
* [python 3](https://www.python.org/)
* [ete3](https://github.com/etetoolkit/ete)
* [numpy](https://github.com/numpy/numpy)
* [pandas](https://github.com/pandas-dev/pandas)
* [joblib](https://github.com/joblib/joblib)
* [cython](https://cython.org/)

## Installation
```
# Installation with pip
pip install git+https://github.com/kfuku52/csubst

# This should show complete options
csubst -h 
```

## Test run
```
# Download a test data
svn export https://github.com/kfuku52/csubst/trunk/data/OG0002332

# Enter the directory
cd ./OG0002332

# Run IQ-TREE to get the .state file
# It's included already
#iqtree \
#-s OG0002332.cds.trimal.fasta \
#-te OG0002332.root.nosupport.nwk \
#-m MFP \
#-st CODON1 \
#-nt 4 \
#-asr

# Run csubst
csubst \
--nslots 4 \
--infile_dir ./ \
--infile_type iqtree \
--aln_file OG0002332.cds.trimal.fasta \
--tre_file OG0002332.root.nosupport.nwk
```

## Licensing
**csubst** is BSD-licensed (3 clause). See [LICENSE](LICENSE) for details.